<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Wallet Token Übersicht</title>

<style>
body { font-family: Arial, sans-serif; }
table { border-collapse: collapse; width: 100%; margin-top: 10px; }
th, td { border: 1px solid #ccc; padding: 6px; font-size: 14px; }
th { background: #f2f2f2; }
tr.spam { background-color: #ffe6e6; }
</style>
</head>

<body>

<h2>Wallet Token Übersicht (Moralis direkt)</h2>
<p>Rot markiert = als Spam erkannt</p>

<table>
<thead>
<tr>
  <th>Wallet</th>
  <th>Chain</th>
  <th>Token-Adresse</th>
  <th>Name</th>
  <th>Anzahl</th>
  <th>Spam</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

<script>
/* ==========================
   KONFIGURATION
========================== */

const MORALIS_API_KEY = "HIER_DEINEN_MORALIS_API_KEY_EINTRAGEN";

const wallets = [
  "0xC7e112D6Db20A4A9213834B2Cb235c34733e6591",
  "0x59dc6669c1eb40df7b36be58812202a09c4491bf",
  "0x76882e6fc045391ba4f19d8a15ea4d8699ff7382",
  "0xbE44d90daD6308AE0b762908D70260c62410346E"
];

// Nur unterstützte Moralis-Chains
const chains = [
  { id: "0x1", name: "Ethereum" },
  { id: "0x38", name: "BSC" },
  { id: "0x89", name: "Polygon" },
  { id: "0xa4b1", name: "Arbitrum" }
];

// Optional
const spamWhitelist = [];
const spamBlacklist = [];

/* ==========================
   SPAM-ERKENNUNG
========================== */
function isSpamToken(t) {
  const addr = (t.token_address || "").toLowerCase();
  const name = (t.name || "").toLowerCase();
  const symbol = (t.symbol || "").toLowerCase();

  if (spamWhitelist.includes(addr)) return false;
  if (spamBlacklist.includes(addr)) return true;

  if (!name || !symbol) return true;
  if (name.length > 40 || symbol.length > 15) return true;

  const spamWords = [
    "airdrop","claim","reward","bonus","promo",
    "gift","free","visit","http","https",".com","scam"
  ];

  return spamWords.some(w => name.includes(w) || symbol.includes(w));
}

/* ==========================
   DATEN LADEN
========================== */
async function loadTokens() {
  const tbody = document.getElementById("tbody");

  for (const wallet of wallets) {
    for (const chain of chains) {
      try {
        const url = `https://deep-index.moralis.io/api/v2/${wallet}/erc20?chain=${chain.id}`;

        const res = await fetch(url, {
          headers: {
            "X-API-Key": MORALIS_API_KEY
          }
        });

        const tokens = await res.json();

        for (const t of tokens) {
          const balance = Number(t.balance) / Math.pow(10, t.decimals);
          if (balance === 0) continue;

          const spam = isSpamToken(t) ? "Ja" : "Nein";

          console.log(wallet, chain.name, t.symbol, balance, spam);

          const tr = document.createElement("tr");
          if (spam === "Ja") tr.classList.add("spam");

          tr.innerHTML = `
            <td>${wallet}</td>
            <td>${chain.name}</td>
            <td>${t.token_address}</td>
            <td>${t.symbol}</td>
            <td>${balance}</td>
            <td>${spam}</td>
          `;
          tbody.appendChild(tr);
        }

      } catch (e) {
        console.error("Fehler:", wallet, chain.name, e);
      }
    }
  }
}

loadTokens();
</script>

</body>
</html>